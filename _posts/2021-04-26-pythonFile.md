---
layout: post
title: python文件处理
categories: Python
description: python文件处理
keywords: python 
---

python关于file文件类型的相关内容

### 1、文件类型 File

文件是操作系统提供给用户/应用程序操作硬盘的一个媒介。用户/应用程序可以通过文件将数据永久保存到硬盘中。

操作文件的过程是在向操作系统发送系统调用，然后再转换成具体的硬盘操作。

python中的file文件类型就是来操控系统文件的。

### 2、基本操作流程

打开文件：`open(url, model)` 函数常用形式是接收两个参数：文件名(file)和模式(mode)。

简单的基本打开文件、读取文件、关闭文件的操作如下：

```py
# 默认的默认就是 ’r‘  mode='rt'  'rt':读模式，文本模式
f = open('./test/a.txt','rt')
print(f)

# 完整的打开 读取  关闭     './test/a.txt'=》’abc‘
f = open('./test/a.txt', 'r')
# print(f) 
data = f.read()
f.close()
print(data)
```

打开文件的路径的分隔符问题：`\`可能会被认为是转义符

```py
# 解决方案一
open(r'a\b\c.d.txt')  # r代表了这个是个纯字符串，\就不代表了反义的符号的含义

# 解决方案二
open('/a/b/c.d.txt')
```

指定字符编码，默认的是`unicode`编码，如果乱码就需要指定字符编码

在文件读取的时候如果没有指定编码，会使用操作系统默认的编码来解码

1. Linux和Mac默认的是`utf-8`
2. Windows默认的是`GBK`

```py
with open('./test/c.txt', mode='rt') as f:
  res = f.read()
  print(res)

```

### 3、with

当打开了一个文件，操作完没有去关闭的时候就会造成浪费，所以要记着打开必须`f.close()`进行关闭，但是总会有遗忘，python提供了一个语法`with`

`with`语句实质是上下文管理。

```py
# 相当于 f = open('./test/a.txt','r')，但是with会自动关闭文件，释放资源
with open('./test/a.txt', mode='r') as f:
  res = f.read()
  print(res)

# 可以打开多个文件
with open('./test/a.txt', mode='r') as f, open('./test/b.txt', mode='r') as f1:
  res = f.read()
  res1 = f1.read()
  print(res)
  print(res1)
```

### 4、文件读写的模式

文件读写的模式分为两种：

1. 控制文件读写内容的模式
2. 控制文件读写操作的模式

控制文件读写内容的模式分为两种：`t`和`b`。这两种必须搭配读写操作的模式使用`r/w/a`

`t`表示文本模式，`b`表示二进制模式

控制文件读写操作的模式分为三种：

1. `r`：只读模式
2. `w`：只写模式
3. `a`：只追加模式

另外还可以有个额外的`+`，三种模式配合`+`之后都可以读写操作

### 5、文件操作模式详解

以`t`模式为基础进行操作

#### 5.1 'rt'模式

`r`模式是默认的模式，为只读模式。

当读取的文件不存在时，会报错，当文件存在时，文件指针跳到开始位置

```py

with open('c.txt', mode='rt' ) as f:
  # read()：不传参的话默认从文件的开始位置一次性读到结尾，读完整个文件到内存里，当文件过大的时候可能会有占满内存的问题
  # read()：接受一个参数，为从文件中读取的字节数，默认为-1，整个文件
  res = f.read()
  print(res)


# 文件有多行
# 这是文件内容
# 写个测试内容2222
# 写个测试内容2223
# 写个测试内容2224
# 写个测试内容2225
# 写个测试内容2226

with open('./test/c.txt') as f:
  for line in f:
    print line

# 输出内容
# 写个测试内容2222

# 写个测试内容2223

# 写个测试内容2224

# 写个测试内容2225

# 写个测试内容2226

# 因为print()方法会默认添加个换行，可以通过`print(line, end='')`来去掉

```

#### 5.2 'wt'模式

`w`模式是只写模式，当文件不存在的时候会创建空文件，当文件存在的时候会清空文件，指针位于开始位置

```py
# 写完操作后，光标在内容的最后
with open('./test/a.txt', mode='wt') as f:
  f.write('写个锤锤')

```

`w`模式打开的瞬间清空文件，在打开且没有关闭的期间持续写内容，会连续写入，每次写入之后指针移动到当前文件的末尾。

```py
# 写完操作后，光标在内容的最后
with open('./test/a.txt', mode='wt') as f:
  f.write('写个锤锤\n')
  f.write('写个锤儿')

# 文件变成
#写个锤锤
#写个锤儿
```

#### 5.3 'at'模式

`a`模式是追加写模式，在文件不存在时会创建空文档,文件存在会将文件指针直接移动到文件末尾，然后再写入要追加写入的内容

```py
with open('./test/a.txt', mode='at') as f:
  f.write('追个锤锤\n')
  f.write('追个锤儿')
```

`a`模式与`w`模式的异同：

- 相同点：在文件不存在的时候都会创建，在文件打开的情况下都会持续写入
- 不同点：`a`模式在文件打开的时候不会清空，指针在文件末尾，新写的内容在文件的最后
