---
layout: post
title: webpack4进阶
categories: tools
description: webpack学习笔记
keywords: webpack4, 前端工程化 
---


webpack4学习笔记三：webpack进阶

### 1. 自动清理构建目录产物

#### 1、使用npm scripts清理构建目录

在`scripts`配置里面加这个语句
```
  rm -rf ./dist && webpack
```

#### 2、自动清理构建目录

使用插件`clean-webpack-plugin`,默认会删除output指定的输出目录

安装：`npm install clean-webpack-plugin -D`

使用：

```
  const {CleanWebpackPlugin} = require('clean-webpack-plugin');

  plugins: [
    new CleanWebpackPlugin()
  ]
```

### 2. 自动补齐css前缀

各个浏览器内核前缀一览：

> trident: -ms
> Geko：-moz
> webkit: -webkit
> presto: -o

自动补齐CSS需要使用到：`autoprefixer`、`postcss-loader`；autoprefixer它是根据www.caniuse.com这个网站的规则来进行补齐的；postcss-loader有很多功能，包括自动补齐css前缀，css module等

安装: ` npm install autoprefixer postcss-loader -D`

使用：

```
  module:{
    rules: [
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader', {
          loader: 'postcss-loader',
          options: {
            plugins: () => [
              require('autoprefixer')({
                "overrideBrowserslist": [
                  "last 2 version",
                  "> 1%"
                ]
              })
            ]
          }
        }]
      }
    ]
  }
```

### 3. css自动做rem转换

使用：`px2rem-loader`插件、淘宝的插件`lib-flexible`, lib-flexible需要手动放到打包好的文件里面的index.html里面，需要手动写一个script，把源码复制放进去。手淘的这个库有个好处，它会比较方便的解决手机端的1px问题。考虑到兼容性的话选择这个，如果不考虑的话可以使用VW or VH

安装：`npm install  px2rem-loader -D`、`npm install lib-flexible -S`

配置：

```
  module:{
    rules: [
      {
        test: /.js$/,
        use: 'babel-loader'
      },
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader', 
          {
            loader: 'postcss-loader',
            options: {
              plugins: () => [
                require('autoprefixer')({
                  "overrideBrowserslist": [
                    "last 2 version",
                    "> 1%"
                  ]
                })
              ]
            }
          },
          {
            loader: 'px2rem-loader',
            options: {
              remUnit: 75, // 1个rem=多少个像素
              remPrecision: 8 //保留几位小数点
            }
          }
        ]
      }
    ]
  },
```

注意事项：
1. 如果是使用`less-loader`的话，需要`['px2rem-loader', 'less-loader']`，注意前后顺序。
2. 如果不想转化，可以使用`/*no*/`语法来注释, `font-size:12px; /*no*/`;
3. 会把第三方UI库的px也转了
4. 适用于移动端，PC还是px好。



